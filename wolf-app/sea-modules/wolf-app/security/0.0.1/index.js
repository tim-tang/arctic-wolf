define("wolf-app/security/0.0.1/index",["./security-app","$","backbone","app-core","app-common","./view/security-login","parsley","./view/security-footer","./authentication/authentication-provider","underscore","./view/forgot-password","./view/reset-password","./view/404","./view/500","./router/security-router","subroute"],function(a,b,c){c.exports.SecurityApp=a("./security-app"),c.exports.AuthenticationProvider=a("./authentication/authentication-provider")}),define("wolf-app/security/0.0.1/security-app",["$","backbone","app-core","app-common","wolf-app/security/0.0.1/view/security-login","parsley","wolf-app/security/0.0.1/view/security-footer","wolf-app/security/0.0.1/authentication/authentication-provider","underscore","wolf-app/security/0.0.1/view/forgot-password","wolf-app/security/0.0.1/view/reset-password","wolf-app/security/0.0.1/view/404","wolf-app/security/0.0.1/view/500","wolf-app/security/0.0.1/router/security-router","subroute"],function(a,b,c){a("$");var d=a("backbone"),e=a("app-core"),f=a("app-common"),g=e.Eventbus,h=e.ViewMgmt,i=f.CommonLoading,j=new d.Layout({el:"#main-body",initialize:function(){g.on("security:show-loading",this.show_loading,this),g.on("security:hide-loading",this.hide_loading,this),g.on("render-security-login",this.render_security_login,this),g.on("render-forgot-password",this.render_forgot_password,this),g.on("render-reset-password",this.render_reset_password,this),g.on("render-404",this.render_404,this),g.on("render-500",this.render_500,this)},beforeRender:function(){},afterRender:function(){},render_security_login:function(){a("wolf-app/security/0.0.1/view/security-login").run("#security-container",h)},render_forgot_password:function(){a("wolf-app/security/0.0.1/view/forgot-password").run("#security-container",h)},render_reset_password:function(){a("wolf-app/security/0.0.1/view/reset-password").run("#security-container",h)},render_404:function(){a("wolf-app/security/0.0.1/view/404").run("#security-container",h)},render_500:function(){a("wolf-app/security/0.0.1/view/500").run("#security-container",h)},show_loading:function(){i.init("#security-container")},hide_loading:function(){i.destroy()},invokeSecurityRouter:function(){var b=a("wolf-app/security/0.0.1/router/security-router");return new b("security/",{createTrailingSlashRoutes:!0})}});c.exports=j}),define("wolf-app/security/0.0.1/view/security-login",["backbone","$","parsley","wolf-app/security/0.0.1/view/security-footer","wolf-app/security/0.0.1/authentication/authentication-provider","underscore","app-core"],function(a,b,c){var d=a("backbone"),e=a("$");a("parsley");var f=a("wolf-app/security/0.0.1/view/security-footer"),g=a("wolf-app/security/0.0.1/authentication/authentication-provider"),h=a("app-core").Eventbus,i=d.View.extend({manage:!0,prefix:"security/src/tpl/",template:"security-login.html",initialize:function(){},afterRender:function(){var a=new f;this.insertView(".middle-login",a).render()},events:{"submit form":"authenticate"},authenticate:function(a){if(a&&a.preventDefault(),e("#security-login-form").parsley().validate()){var b=e("#username").val(),c=e("#password").val();h.trigger("security:show-loading"),g.authenticate({username:b,password:c},function(){h.trigger("security:hide-loading")})}else console.log("Client side validate error.")}});c.exports={run:function(a,b){b.showLogin(a,new i)}}}),define("wolf-app/security/0.0.1/view/security-footer",["backbone"],function(a,b,c){var d=a("backbone"),e=d.View.extend({manage:!0,prefix:"security/src/tpl/",template:"security-footer.html"});c.exports=e}),define("wolf-app/security/0.0.1/authentication/authentication-provider",["backbone","$","underscore"],function(a,b,c){var d=a("backbone"),e=a("$");a("underscore");var f=d.Model.extend({url:"http://localhost:5000/security",initialize:function(){Storage&&sessionStorage&&(this.supportStorage=!0)},get:function(a){if(!this.supportStorage)return d.Model.prototype.get.call(this,a);var b=sessionStorage.getItem(a);return b&&"{"!==b[0]?b:JSON.parse(b)},put:function(a,b){return this.supportStorage?sessionStorage.setItem(a,b):d.Model.prototype.set.call(this,a,b),this},remove:function(a){return this.supportStorage?sessionStorage.removeItem(a):d.Model.prototype.unset.call(this,a),this},clear:function(){return this.supportStorage?(sessionStorage.clear(),void 0):d.Model.prototype.clear(this)},authenticate:function(a,b){var c=this,f=e.ajax({url:this.url+"/authenticate",data:a,type:"POST"});f.done(function(a){if(c.put("authenticated",!0),c.put("security-user",JSON.stringify(a.security_user)),!c.get("redirect-url"))return d.history.navigate("#dashboard/",{trigger:!0}),b();var e=c.get("redirect-url");c.remove("redirect-url"),d.history.navigate(e,{trigger:!0}),b()}),f.fail(function(){d.history.navigate("#security/login",{trigger:!0}),b()})},signout:function(a){var b=this,c=e.ajax({url:this.url+"/signout",type:"DELETE"});c.done(function(){b.clear(),a()})}});c.exports=new f}),define("wolf-app/security/0.0.1/view/forgot-password",["$","backbone","wolf-app/security/0.0.1/view/security-footer"],function(a,b,c){var d=a("$"),e=a("backbone"),f=a("wolf-app/security/0.0.1/view/security-footer"),g=e.View.extend({manage:!0,prefix:"security/src/tpl/",template:"forgot-password.html",events:{"submit form":"send_email"},initialize:function(){this.subviews=[]},beforeRender:function(){d("#main-body").addClass("texture")},afterRender:function(){var a=new f;this.subviews.push(a),this.insertView(".middle",a).render()},send_email:function(a){a.preventDefault(),e.history.navigate("security/reset-password",!0)}});c.exports={run:function(a,b){b.show(a,new g)}}}),define("wolf-app/security/0.0.1/view/reset-password",["$","backbone","wolf-app/security/0.0.1/view/security-footer"],function(a,b,c){var d=a("$"),e=a("backbone"),f=a("wolf-app/security/0.0.1/view/security-footer"),g=e.View.extend({manage:!0,prefix:"security/src/tpl/",template:"reset-password.html",initialize:function(){this.subviews=[]},beforeRender:function(){d("#main-body").addClass("texture")},afterRender:function(){var a=new f;this.subviews.push(a),this.insertView(".middle",a).render()}});c.exports={run:function(a,b){b.show(a,new g)}}}),define("wolf-app/security/0.0.1/view/404",["$","backbone","wolf-app/security/0.0.1/view/security-footer"],function(a,b,c){var d=a("$"),e=a("backbone"),f=a("wolf-app/security/0.0.1/view/security-footer"),g=e.View.extend({manage:!0,prefix:"security/src/tpl/",template:"404.html",initialize:function(){this.subviews=[]},beforeRender:function(){d("#main-body").addClass("texture")},afterRender:function(){var a=new f;this.subviews.push(a),this.insertView(".middle",a).render()}});c.exports={run:function(a,b){b.show(a,new g)}}}),define("wolf-app/security/0.0.1/view/500",["$","backbone","wolf-app/security/0.0.1/view/security-footer"],function(a,b,c){var d=a("$"),e=a("backbone"),f=a("wolf-app/security/0.0.1/view/security-footer"),g=e.View.extend({manage:!0,prefix:"security/src/tpl/",template:"500.html",initialize:function(){this.subviews=[]},beforeRender:function(){d("#main-body").addClass("texture")},afterRender:function(){var a=new f;this.subviews.push(a),this.insertView(".middle",a).render()}});c.exports={run:function(a,b){b.show(a,new g)}}}),define("wolf-app/security/0.0.1/router/security-router",["backbone","app-core","subroute"],function(a,b,c){var d=a("backbone"),e=a("app-core").Eventbus;a("subroute");var f=d.SubRoute.extend({initialize:function(){},routes:{login:"login","forgot-password":"forgot_password","reset-password":"reset_password"},login:function(){e.trigger("render-security-login")},forgot_password:function(){e.trigger("render-forgot-password")},reset_password:function(){e.trigger("render-reset-password")}});c.exports=f});
